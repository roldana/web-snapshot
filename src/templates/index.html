<!doctype html>
<html lang="en" data-theme="light">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Web Snapshot</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='styles.css') }}">
</head>
<body>
  <div class="app-shell">
    <header class="topbar">
      <div class="brand">[] <span>Snapshot</span></div>
      <nav class="top-actions">
        <button id="themeToggle" class="btn btn-ghost" type="button">D/L</button>
        <a class="btn btn-ghost" href="{{ url_for('about') }}">About</a>
      </nav>
    </header>

    <main class="content">
      <!-- LEFT: History -->
      <aside class="history">
        <h3>Recent Captures</h3>
        {% if history %}
          <ul class="history-list">
            {% for row in history %}
              <li class="history-item">
                <div class="history-url" title="{{ row['url'] }}">{{ row["url"] }}</div>
                <div class="history-meta">
                  <span class="badge badge-{{ row['status'] }}">{{ row["status"] }}</span>
                  <span class="time">{{ row["created_at"][:19].replace('T', ' ') }}</span>
                </div>
                <div class="history-options">
                  {% if row["full_page"] %}<span>Full Page</span>{% endif %}
                  {% if row["mobile_view"] %}<span>Mobile</span>{% endif %}
                </div>
                {% if row["error"] %}
                  <div class="history-error">{{ row["error"] }}</div>
                {% endif %}
              </li>
            {% endfor %}
          </ul>
        {% else %}
          <p class="muted">No captures yet.</p>
        {% endif %}
      </aside>

      <!-- RIGHT: Main input area -->
      <section class="main-capture">
        <div class="hero">
          <h1>Web Snapshot</h1>
        </div>

        {% with messages = get_flashed_messages(with_categories=true) %}
          {% if messages %}
            <div class="flash-stack">
              {% for category, message in messages %}
                <div class="flash flash-{{ category }}">{{ message }}</div>
              {% endfor %}
            </div>
          {% endif %}
        {% endwith %}

        <form action="{{ url_for('capture') }}" method="post" class="capture-form">
          <input
            type="text"
            name="url"
            placeholder="https://example.com"
            aria-label="Website URL"
            required
          />
          <button type="submit" class="btn btn-primary">RUN</button>
        </form>

        <div class="options">
          <label><input type="checkbox" name="full_page" form="capture-form-fallback" checked> Full Page</label>
          <label><input type="checkbox" name="mobile_view" form="capture-form-fallback"> Mobile View</label>
          <label><input type="checkbox" name="pdf_gen" form="capture-form-fallback">PDF</label>
          <label><input type="checkbox" name="all_domain" form="capture-form-fallback">All Domain</label>
          <label><input type="checkbox" name="screenshot" form="capture-form-fallback">Screenshot</label>


        </div>
      </section>
    </main>
  </div>

  <!-- Hidden helper form so checkboxes can style consistently; we sync it with JS -->
  <form id="capture-form-fallback" style="display:none"></form>

  <script src="{{ url_for('static', filename='app.js') }}"></script>
</body>
</html>